Show Customers (their full names, customer ID, and country) who are not in the US.

SELECT * FROM chinook.customers;
SELECT CustomerId, FirstName, LastName, Country
FROM chinook.customers
WHERE Country <> 'USA';

Show only the Customers from Brazil.
SELECT CustomerId, FirstName, LastName
FROM chinook.customers
WHERE Country ='Brazil';

--Find the Invoices of customers who are from Brazil. 
--customer's full name, Invoice ID, Date of the invoice, and billing country.
SELECT * FROM chinook.invoices;
SELECT c.FirstName, c.LastName, i.InvoiceId, i.InvoiceDate, i.BillingCountry
FROM chinook.customers c
JOIN chinook.invoices i
ON c.Customerid = i.Customerid
WHERE c.Country ='Brazil';

--Show the Employees who are Sales Agents.
SELECT * FROM chinook.employees;
SELECT Employeeid, FirstName,LastName
FROM chinook.employees
WHERE Title LIKE 'Sales%Agent';

--Find a unique/distinct list of billing countries from the Invoice table.

SELECT DISTINCT BillingCountry
FROM chinook.invoices;

##Provide a query that shows the invoices associated with each sales agent. The 
resulting table should include the Sales Agent's full name.

SELECT i.Invoiceid, i.InvoiceDate, i.Total, e.FirstName, e.LastName
FROM chinook.invoices i
JOIN chinook.customers c
ON I.Customerid = c.Customerid
JOIN chinook.employees e
ON c.SupportRepid = e.Employeeid
WHERE e.Title LIKE 'Sales%Agent'
ORDER BY i.Invoiceid;SELECT i.Invoiceid, i.InvoiceDate, i.Total, e.FirstName, e.LastName
FROM chinook.invoices i
JOIN chinook.customers c
ON I.Customerid = c.Customerid
JOIN chinook.employees e
ON c.SupportRepid = e.Employeeid
WHERE e.Title LIKE 'Sales%Agent'
ORDER BY i.Invoiceid;

##Show the Invoice Total, Customer name, Country, and Sales Agent name for all
invoices and customers.

SELECT c.FirstName, c.LastName, i.Total,c.Country,e.LastName, e.FirstName
FROM chinook.invoices i
    JOIN chinook.customers c
    ON c.Customerid = i.Customerid
    JOIN chinook.employees e
    ON c.SupportRepid = e.Employeeid;

--How many Invoices were there in 2009?

 SELECT COUNT(InvoiceId)
 FROM chinook.invoices
 WHERE InvoiceDate LIKE '2009%';


--What are the total sales for 2009?
SELECT ROUND(SUM(Total),2) AS Total_Sales
FROM chinook.invoices
WHERE InvoiceDate LIKE '2009%';

--Write a query that includes the purchased track name with each invoice line ID.

SELECT i.InvoiceLineid,t.name
FROM chinook.tracks t
JOIN chinook.invoice_items i
ON t.Trackid = i.Trackid
ORDER BY i.InvoiceLineid; 

--Write a query that includes the purchased track name AND artist name with each invoice line ID
SELECT i.InvoiceLineid,t.name, a.Name
FROM chinook.tracks t
JOIN chinook.invoice_items i
ON t.Trackid = i.Trackid
JOIN chinook.albums al
ON t.Albumid = al.Albumid
JOIN chinook.artists a
ON a.Artistid = al.Artistid
ORDER BY i.InvoiceLineid; 

--Provide a query that shows all the Tracks, and include the Album name, Media type, and Genre.

SELECT t.Name AS Track_Name, a.Title AS Album,m.Name AS Type, g.Name AS Genre
FROM chinook.tracks t
JOIN chinook.albums a
ON t.Albumid = a.AlbumId
JOIN chinook.media_types m
ON t.MediaTypeid = m.MediaTypeId
JOIN chinook.genres g
ON t.Genreid = g.GenreId;

--Show the total sales made by each sales agent.

SELECT ROUND(SUM(i.Total),2) AS Total_Sales, e.FirstName, e.LastName
FROM chinook.employees e
JOIN chinook.customers c
ON e.Employeeid = c.SupportRepId
JOIN chinook.invoices i
ON i.CustomerId = c.CustomerId
GROUP BY e.FirstName, e.LastName
HAVING e.Title LIKE 'Sales%Agent';

--Which sales agent made the most dollars in sales in 2009?

SELECT ROUND(SUM(i.Total),2) AS Total_Sales, e.FirstName, e.LastName
FROM chinook.employees e
JOIN chinook.customers c
ON e.Employeeid = c.SupportRepId
JOIN chinook.invoices i
ON i.CustomerId = c.CustomerId
GROUP BY e.FirstName, e.LastName
HAVING e.Title LIKE 'Sales%Agent'
AND I.InvoiceDate LIKE '2009%'
ORDER BY Total_Sales DESC LIMIT 1;
